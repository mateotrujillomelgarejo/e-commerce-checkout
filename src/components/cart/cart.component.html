<div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-bold">Tu carrito</h2>
    <a routerLink="/products" class="px-3.5 py-2.5 rounded-[10px] bg-transparent border border-black/10 text-[#333] font-semibold transition-all duration-200 ease-in-out hover:border-[#ff6b9a] hover:text-[#ff6b9a] no-underline">Seguir comprando</a>
</div>

@if (cartService.loading()) {
    <p>Cargando carrito...</p>
} @else if (cartService.cart() && cartService.cartCount() > 0) {
    @let cart = cartService.cart()!;
    <section class="grid grid-cols-1 md:grid-cols-[1fr_360px] gap-6">
        <div class="flex flex-col gap-2.5">
            @for (item of cart.items; track item.id) {
            <div class="flex gap-3 items-center p-2.5 bg-white rounded-[10px] border border-black/5">
                <img [src]="item.img" [alt]="item.productName" class="w-20 h-20 sm:w-24 sm:h-24 object-cover rounded-lg">
                <div class="flex-grow">
                    <h3 class="font-bold text-sm sm:text-base">{{ item.productName }}</h3>
                    <p class="text-[#ff6b9a] font-bold text-sm">S/ {{ item.price | number:'1.2-2' }}</p>
                </div>
                <div class="flex items-center gap-3">
                    <input type="number" [value]="item.quantity" (change)="updateQuantity(item.productId, $event)" class="w-16 p-1.5 rounded-lg border border-black/10 text-center">
                    <button (click)="removeItem(item.productId)" class="text-red-500 hover:text-red-700 text-xs sm:text-sm">Eliminar</button>
                </div>
            </div>
            }
        </div>

        <aside class="bg-gradient-to-b from-white to-[#fff3f6] p-4 rounded-xl border border-[rgba(255,107,154,0.08)] self-start">
            <h3 class="text-lg font-bold mb-4">Resumen de compra</h3>
            <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                    <span>Subtotal</span>
                    <span>S/ {{ cart.subtotal | number:'1.2-2' }}</span>
                </div>
                <div class="flex justify-between">
                    <span>Envío</span>
                    <span>S/ {{ cart.shipping | number:'1.2-2' }}</span>
                </div>
                <hr class="my-2">
                <div class="flex justify-between font-bold text-base">
                    <span>Total</span>
                    <span>S/ {{ cart.total | number:'1.2-2' }}</span>
                </div>
            </div>
            <a routerLink="/checkout" class="block w-full text-center mt-5 px-3.5 py-2.5 rounded-[10px] bg-[#ff6b9a] text-white font-semibold transition-all duration-200 ease-in-out hover:bg-[#ff5b90] hover:-translate-y-px no-underline">Proceder al pago</a>
        </aside>
    </section>
} @else {
    <div class="text-center py-10 bg-white rounded-xl shadow-sm">
        <p>Tu carrito está vacío.</p>
        <a routerLink="/products" class="mt-4 inline-block px-3.5 py-2.5 rounded-[10px] bg-[#ff6b9a] text-white font-semibold transition-all duration-200 ease-in-out hover:bg-[#ff5b90] hover:-translate-y-px no-underline">Ver productos</a>
    </div>
}
